import glob
import json
import pandas as pd

description_files = glob.glob('test*/*.json')

print("the description files : ")
print(description_files)
print("will be imported")


# Let's import all json files into a list of dictionaries
all_descriptions = []

for file_name in description_files:
    with open(file_name, 'r') as fd:
        # bla=json.load(fd)
        # print('db1:')
        # print(bla)
        all_descriptions.append(json.load(fd))
        # print('db2:')
        # print(all_descriptions)


print("json files have been imported")

print(all_descriptions)

# Let's create a pandas dataframe out of our dict list
df = pd.DataFrame(all_descriptions)
print("the pandas dataframe has been created")

list_of_all_columns = df.columns
print("printing the columns of the dataframe")
print(list_of_all_columns)

print("printing the dataframe")
print(df)

# print values of columns: the name of the column can be used as attributes
print("values of the Name column")
print(df.Name)


# a new dataframe with a few columns only
column_list = ['Geometry', 'CFL']
sub_df1 = df[column_list]
print("sub_df1")
print(sub_df1)

# a new dataframe according to the CFL value
sub_df2 = df[df.CFL > 0.1]
print("sub_df2")
print(sub_df2)

# sorting a dataframe
df.sort_values(by=['Name', 'CFL'], ascending=True)

sub_df3 = df[df['Boundary conditions'].isin(['Dirichlet'])]
print("sub_df3")
print(sub_df3)
